<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <meta name="description" content="Create a SIP user agent using SIP.js so your WebRTC application can send and receive calls and messages." />
  <meta name="viewport" content="initial-scale=1" />
  <title>User Agent | SIP.js</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href='//fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round' rel='stylesheet' type='text/css'>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css" />
    
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css" />
  
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/shared/img/favicon-7.ico"/>
</head>


<body class="guides">
  <div id="dev"></div>
<header id="siteHeader">
  <div class="wrapper">
    <nav id="mainNav">
      <a id="logo-link" href="/"><img id="logo" src="/shared/img/logo.png" alt="sip.js"></a>
      <ul id="full-nav" class="horizontal mobile-hide">
        <li><a href="/download/">Download</a></li>
        <li><a id="api-nav" href="/api/0.15.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
  </div>
</header>


  <article id="main" class="wrapper group">
    <header id="sectionHeader">
      <h1><a href="/guides/">Guides</a></h1>
    </header>
    <div id="content">
      
<h1 id="user-agent">User Agent</h1>

<p>This guide uses the full <a href="https://github.com/onsip/SIP.js/blob/master/docs/api/sip.js.md">SIP.js API</a>. The <a href="./simple">Simple User</a> is intended to help get beginners up and running quickly. This guide is adopted from the <a href="https://github.com/onsip/SIP.js/blob/master/docs/api.md">SIP.js Github API documentation</a>.</p>

<h3 id="transport-options">Transport Options</h3>

<p>The first thing SIP.js needs to know is where it will connect to. This guide assumes that you are using the default WebSocket Transport that is included with SIP.js. The only parameter that is required is a Websocket URL for your SIP Websocket server.</p>

<pre><code class="language-javascript"><span class="kr">const</span> <span class="nx">transportOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">server</span><span class="o">:</span> <span class="s2">"wss://example.com:8443"</span>
<span class="p">};</span></code></pre>

<h3 id="anonymous-user-agent">Anonymous User Agent</h3>

<p>In order to make calls and send messages you must create a SIP user agent.  In this example, we will create an anonymous user agent.  To do this, call the <code>new UserAgent(userAgentOptions)</code> constructor. No options are required by the library, but it is recommended that you pass <code>transportOptions</code> to indicate where SIP.js should connect to. An anonymous user agent can make calls and send messages to SIP endpoints.  It cannot receive calls or messages.</p>

<pre><code class="language-javascript"><span class="kr">const</span> <span class="nx">userAgent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UserAgent</span><span class="p">({</span><span class="nx">transportOptions</span><span class="p">});</span>
<span class="nx">userAgent</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span></code></pre>

<h3 id="authenticated-user-agent">Authenticated User Agent</h3>

<p>To create an authenticated user agent add a <code>URI</code>, <code>authorizationUsername</code>, <code>authorizationPassword</code> to the configuration option passed to the <code>new UserAgent(userAgentOptions)</code> constructor. The <code>URI</code> option is specifically typed as a <code>URI</code> type and not a string. There is a static helper function <code>makeURI(uri: string)</code> on the <code>UserAgent</code> that can help create this type.</p>

<pre><code class="language-javascript"><span class="kr">const</span> <span class="nx">uri</span> <span class="o">=</span> <span class="nx">UserAgent</span><span class="p">.</span><span class="nx">makeURI</span><span class="p">(</span><span class="s2">"sip:alice@example.com"</span><span class="p">);</span></code></pre>

<p>Once a URI is created the rest of the <a href="https://github.com/onsip/SIP.js/blob/master/docs/api/sip.js.useragentoptions.md">user agent options</a> can be added to the options object. The Most platforms will require and <code>authorizationUsername</code> and <code>authorizationPassword</code> to authorize your user.</p>

<pre><code class="language-javascript"><span class="kr">const</span> <span class="nx">userAgentOptions</span><span class="o">:</span> <span class="nx">UserAgentOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">authorizationPassword</span><span class="o">:</span> <span class="s1">'secretPassword'</span><span class="p">,</span>
  <span class="nx">authorizationUsername</span><span class="o">:</span> <span class="s1">'authorizationUsername'</span><span class="p">,</span>
  <span class="nx">transportOptions</span><span class="p">,</span>
  <span class="nx">uri</span>
<span class="p">};</span>
<span class="kr">const</span> <span class="nx">userAgent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UserAgent</span><span class="p">(</span><span class="nx">userAgentOptions</span><span class="p">);</span></code></pre>

<p>After the User Agent is created it will need to Register in order to authenticate with the server and receive messages. To do this a <code>new Registerer(userAgent: UserAgent)</code> needs to be created. A <a href="https://github.com/onsip/SIP.js/blob/master/docs/api/sip.js.registerer.md"><code>Registerer</code></a> will register and automatically handle re-registrations when required.</p>

<pre><code class="language-javascript"><span class="kr">const</span> <span class="nx">registerer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Registerer</span><span class="p">(</span><span class="nx">userAgent</span><span class="p">);</span></code></pre>

<p>Now that everything is created it can all be started. First the <code>UserAgent</code> must be started. This tells the user agent to connect to the Transport. Once the user agent is started then the <code>Registerer</code> can be told to <code>register()</code> the user agent.</p>

<pre><code class="language-javascript"><span class="nx">userAgent</span><span class="p">.</span><span class="nx">start</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">registerer</span><span class="p">.</span><span class="nx">register</span><span class="p">();</span>
<span class="p">});</span></code></pre>

    </div>

    <nav id="sideNav">
  <ul>
    <li><a href="/guides/">Overview</a></li>
    <li class="parent">
      <a class="parent" href="/guides/server-configuration/">Server Configuration</a>
      <ul>
        <li><a href="/guides/server-configuration/freeswitch/">FreeSWITCH</a></li>
        <li><a href="/guides/server-configuration/asterisk/">Asterisk</a></li>
        <li><a href="/guides/server-configuration/onsip-network/">OnSIP</a></li>
      </ul>
    </li>
    <li><a href="/guides/simple-user/">Simple User</a></li>
    <li><a href="/guides/user-agent/">User Agent</a></li>
    <li><a href="/guides/make-call/">Make a Call</a></li>
    <li><a href="/guides/receive-call/">Receive a Call</a></li>
    <li><a href="/guides/end-call/">End a Call</a></li>
    <li><a href="/guides/attach-media/">Attach Media</a></li>
    <li><a href="/guides/send-dtmf/">Send DTMF</a></li>
    <li><a href="/guides/send-message/">Send Message</a></li>
    <li><a href="/guides/transfer/">Make a Transfer</a></li>
    <li><a class="last" href="/guides/full-demo-app/">Application Demo</a></li>
  </ul>
</nav>


  </article>

  <footer class="light-gray-bg">
  <div class="wrapper">
    <div id="onsip-stamp">
      <span id="made-by-prefix">made by</span>
      <a href="http://developer.onsip.com" id="onsip"></a>
    </div>
    <nav class="left">
      <ul class="horizontal">
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Mailing List</a></li>
        <li><a href="https://github.com/onsip/sip.js/issues" target="_blank">Report Issues</a></li>
        <li><a href="/license/">License</a></li>
      </ul>
    </nav>
    <nav class="right">
      <ul class="horizontal">
        <li><a href="https://travis-ci.org/onsip/SIP.js"><img src="https://travis-ci.org/onsip/SIP.js.png?branch=master"/></a></li>
        <li><a href="http://onsip.com/blog" target="_blank">Blog</a></li>
        <li><a href="/aboutus/">About</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
    <div class="clearfix"></div>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1008379-16', 'sipjs.com');
  ga('send', 'pageview');
</script>
<script>
  // Remove all 'no-js-hide' classes because Javascript is working
  $(function () {
      $('.no-js-hide').each(function (i, e) {
          $(e).removeClass('no-js-hide');
      });
      $('.no-js-block').each(function (i, e) {
          $(e).removeClass('no-js-block');
      });
  });
</script>


</body>
</html>
