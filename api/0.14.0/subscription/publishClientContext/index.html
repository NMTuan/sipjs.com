<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <meta name="description" content="In SIP.js, a SIP.PublishClientContext encapsulates the behavior required to send a refer, as well as handle responses and retransmissions of that refer." />
  <meta name="viewport" content="initial-scale=1" />
  <title>SIP.PublishClientContext | SIP.js</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href='//fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round' rel='stylesheet' type='text/css'>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css" />
    
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css" />
  
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/shared/img/favicon-7.ico"/>
</head>


<body class="api">
	<div id="dev"></div>
<header id="siteHeader">
  <div class="wrapper">
    <nav id="mainNav">
      <a id="logo-link" href="/"><img id="logo" src="/shared/img/logo.png" alt="sip.js"></a>
      <ul id="full-nav" class="horizontal mobile-hide">
        <li><a href="/download/">Download</a></li>
        <li><a id="api-nav" href="/api/0.15.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
  </div>
</header>


	<article id="main" class="wrapper group">
		<header id="sectionHeader">
			<h1><a href="/api/">API</a></h1>
			<nav id="subNav">
				<ul class="horizontal">
					<li class="first"><a href="/api/0.14.0/">0.14.x</a></li>
				</ul>
			</nav>
		</header>
		<div id="content">
			<h1 id="sippublishclientcontext">SIP.PublishClientContext</h1>

<p>A <code>SIP.PublishClientContext</code> encapsulates the behavior required to send a SIP publish event as outlined in <a href="https://www.ietf.org/rfc/rfc3903.txt">RFC 3903</a>. Currently only outgoing publish requests are supported, hence you will not find a <code>PublishServerContext</code>.</p>

<ul id="markdown-toc">
  <li><a href="#construction" id="markdown-toc-construction">Construction</a></li>
  <li>
<a href="#instance-attributes" id="markdown-toc-instance-attributes">Instance Attributes</a>    <ul>
      <li><a href="#event" id="markdown-toc-event">event</a></li>
      <li><a href="#target" id="markdown-toc-target">target</a></li>
      <li><a href="#body" id="markdown-toc-body">body</a></li>
      <li><a href="#options" id="markdown-toc-options">options</a></li>
      <li><a href="#optionsextraheaders" id="markdown-toc-optionsextraheaders">options.extraHeaders</a></li>
      <li><a href="#optionscontenttype" id="markdown-toc-optionscontenttype">options.contentType</a></li>
      <li><a href="#optionsexpires" id="markdown-toc-optionsexpires">options.expires</a></li>
      <li><a href="#optionsunpublishonclose" id="markdown-toc-optionsunpublishonclose">options.unpublishOnClose</a></li>
    </ul>
  </li>
  <li>
<a href="#instance-methods" id="markdown-toc-instance-methods">Instance Methods</a>    <ul>
      <li><a href="#publishbody" id="markdown-toc-publishbody"><code>publish([body])</code></a></li>
      <li><a href="#unpublish" id="markdown-toc-unpublish"><code>unpublish()</code></a></li>
      <li><a href="#close" id="markdown-toc-close"><code>close()</code></a></li>
      <li><a href="#sendpublishrequest" id="markdown-toc-sendpublishrequest"><code>sendPublishRequest()</code></a></li>
      <li><a href="#receiveresponse" id="markdown-toc-receiveresponse"><code>receiveResponse()</code></a></li>
    </ul>
  </li>
  <li><a href="#events" id="markdown-toc-events">Events</a></li>
</ul>

<h2 id="construction">Construction</h2>

<p>Typically, construction and sending of a PublishClientContext is managed by a <code>SIP.UA</code>, through the <code>ua.publish(target, event, body[, options])</code> function.</p>

<h4 id="parameters">Parameters</h4>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>target</td>
      <td>
<code>String</code> | <code>SIP.URI</code>
</td>
      <td>The destination URI for the request to send to.</td>
    </tr>
    <tr>
      <td>event</td>
      <td><code>String</code></td>
      <td>The event to publish</td>
    </tr>
    <tr>
      <td>body</td>
      <td><code>String</code></td>
      <td>The body for the request</td>
    </tr>
    <tr>
      <td>options</td>
      <td><code>Object</code></td>
      <td>Optional options to use for the <code>PublishClientContext</code>, see below</td>
    </tr>
  </tbody>
</table>

<h2 id="instance-attributes">Instance Attributes</h2>

<h3 id="event">event</h3>

<p><code>string</code>, event to publish</p>

<h3 id="target">target</h3>

<table>
  <tbody>
    <tr>
      <td><code>string</code></td>
      <td>
<code>SIP.URI</code>, request target</td>
    </tr>
  </tbody>
</table>

<h3 id="body">body</h3>

<p><code>string</code>, request body to send with publish</p>

<h3 id="options">options</h3>

<p><code>object</code>, optional. Object with extra parameters, see below</p>

<h3 id="optionsextraheaders">options.extraHeaders</h3>

<p><code>array</code>, optional. Array of strings with extra SIP headers to add with publish/unpublish requests</p>

<h3 id="optionscontenttype">options.contentType</h3>

<p><code>string</code>, optional. Content-Type header representing body content type. Default is ‘text/plain’</p>

<h3 id="optionsexpires">options.expires</h3>

<p><code>int</code>, optional. Default expire value for the published event. If not set, default value 3600 is used</p>

<h3 id="optionsunpublishonclose">options.unpublishOnClose</h3>

<p><code>boolean</code>, optional. If set true, UA will gracefully unpublish for the event on UA close. Default value is true.</p>

<h2 id="instance-methods">Instance Methods</h2>

<h3 id="publishbody"><code>publish([body])</code></h3>
<p>publish the event state. Used for updating the current state for the event or to restore the publish after the unpublish was called. When no body provided, existing state is refreshed ( no need to do this manually, as state will be refreshed periodically on 0.9 * Expire intervals)</p>

<h3 id="unpublish"><code>unpublish()</code></h3>
<p>removes published event</p>

<h3 id="close"><code>close()</code></h3>
<p>removes published event and UA internal pointer to the object</p>

<h3 id="sendpublishrequest"><code>sendPublishRequest()</code></h3>
<p><em>Internal</em> Is called by <code>publish()</code>, this function is what actually sends the request via <code>SIP.OutgoingRequest</code></p>

<h3 id="receiveresponse"><code>receiveResponse()</code></h3>
<p><em>Internal</em> Handles the response by the Event State Compositor (see <a href="https://www.ietf.org/rfc/rfc3903.txt">RFC 3903</a>)</p>

<h2 id="events">Events</h2>

<p><code>published</code> Fired for a publish request success (2xx response received on PUBLISH request)
<code>
.on('published', function (response, cause) {});
</code></p>

<p><code>unpublished</code> Fired for a unpublish request success or for a periodic publish refresh failure
<code>
.on('unpublished', function (response, cause) {});
</code></p>

<p><code>progress</code> Fired for a publish/unpublish request progress. This event indicate session progress state (1xx response received) or recovering after the 412 or 423 responses
<code>
.on('progress', function (response, cause) {});
</code></p>

<p><code>failed</code> Fired for a publish request failure or on a periodic publish refresh failure
<code>
.on('failed', function (response, cause) {});
</code></p>

		</div>

		<nav id="sideNav">
  <ul>


    <li class="header"><a href="/api/0.14.0/">Overview</a></li>

    <li class="parent">
      <a class="parent" href="/api/0.14.0/simple/">Simple</a>
      <ul>
        <li><a href="/api/0.14.0/simple_configuration_parameters/">Simple Configuration Parameters</a></li>
      </ul>
    </li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/ua/">UA (User Agent)</a>
      <ul>
        <li><a href="/api/0.14.0/ua_configuration_parameters/">UA Configuration Parameters</a></li>
      </ul>
    </li>
    <li><a href="/api/0.14.0/session/">Session</a></li>
    <li><a href="/api/0.14.0/sessionDescriptionHandler/">Session Description Handler</a></li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/transport/">Transport</a>
      <ul>
        <li><a class="parent" href="/api/0.14.0/wstransport/">WebSocket Transport</a></li>
      </ul>
    </li>


    <li class="header"><a href="/api/0.14.0/context/">Contexts</a></li>


    <li><a href="/api/0.14.0/context/client/">Client Context</a></li>
    <li><a href="/api/0.14.0/context/server/">Server Context</a></li>

    <li><a href="/api/0.14.0/message/">Message</a></li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/refer/">Refer</a>
      <ul>
        <li><a href="/api/0.14.0/refer/referClientContext/">Refer Client Context</a></li>
        <li><a href="/api/0.14.0/refer/referServerContext/">Refer Server Context</a></li>
      </ul>
    </li>
    <li><a href="/api/0.14.0/register">Register Context</a></li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/subscription/">Subscription</a>
      <ul>
        <li><a href="/api/0.14.0/subscription/publishClientContext/">Publish Client Context</a></li>
        <li><a href="/api/0.14.0/subscription/subscription/">Subscription Client Context</a></li>
      </ul>
    </li>

    <li class="header"><div class="title">Data Structures</li>


    <li class="parent">
      <a class="parent" href="/api/0.14.0/uri/">URI</a>
      <ul>
        <li><a href="/api/0.14.0/uri/#construction">Construction</a></li>
        <li><a href="/api/0.14.0/uri/#instance-methods">Instance Methods</a></li>
	<li><a href="/api/0.14.0/uri/#static-methods">Static Methods</a></li>
      </ul>
    </li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/nameAddrHeader/">NameAddrHeader</a>
      <ul>
	<li><a href="/api/0.14.0/nameAddrHeader/#construction">Construction</a></li>
        <li><a href="/api/0.14.0/nameAddrHeader/#instance-variables">Instance Variables</a></li>
        <li><a href="/api/0.14.0/nameAddrHeader/#instance-methods">Instance Methods</a></li>
	<li><a href="/api/0.14.0/nameAddrHeader/#static-methods">Static Methods</a></li>
      </ul>
    </li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/sipMessage/">Requests and Responses</a>
      <ul>
        <li><a href="/api/0.14.0/sipMessage/#instance-variables">Instance Variables</a></li>
        <li><a href="/api/0.14.0/sipMessage/#instance-methods">Instance Methods</a></li>
      </ul>
    </li>


    <li class="header"><div class="title">Advanced</div></li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/grammar/">SIP.Grammar</a>
      <ul>
        <li><a href="/api/0.14.0/grammar/#instance-variables">Instance Variables</a></li>
	<li><a href="/api/0.14.0/grammar/#methods">Methods</a></li>
      </ul>
    </li>
    <li class="parent">
      <a class="parent" href="/api/0.14.0/causes/">Failure and End Causes</a>
      <ul>
        <li><a href="/api/0.14.0/causes/#common-causes">Common Causes</a></li>
        <li><a href="/api/0.14.0/causes/#sip-error-causes">Sip Error Causes</a></li>
        <li><a href="/api/0.14.0/causes/#session-causes">Session Causes</a></li>
      </ul>
    </li>
  </ul>
</nav>


	</article>

	<footer class="light-gray-bg">
  <div class="wrapper">
    <div id="onsip-stamp">
      <span id="made-by-prefix">made by</span>
      <a href="http://developer.onsip.com" id="onsip"></a>
    </div>
    <nav class="left">
      <ul class="horizontal">
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Mailing List</a></li>
        <li><a href="https://github.com/onsip/sip.js/issues" target="_blank">Report Issues</a></li>
        <li><a href="/license/">License</a></li>
      </ul>
    </nav>
    <nav class="right">
      <ul class="horizontal">
        <li><a href="https://travis-ci.org/onsip/SIP.js"><img src="https://travis-ci.org/onsip/SIP.js.png?branch=master"/></a></li>
        <li><a href="http://onsip.com/blog" target="_blank">Blog</a></li>
        <li><a href="/aboutus/">About</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
    <div class="clearfix"></div>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1008379-16', 'sipjs.com');
  ga('send', 'pageview');
</script>
<script>
  // Remove all 'no-js-hide' classes because Javascript is working
  $(function () {
      $('.no-js-hide').each(function (i, e) {
          $(e).removeClass('no-js-hide');
      });
      $('.no-js-block').each(function (i, e) {
          $(e).removeClass('no-js-block');
      });
  });
</script>


</body>
</html>
